Aggregate [(sum(l_extendedprice#84) / 7.0) AS (sum(l_extendedprice) / 7.0)#501]
+- Project [l_extendedprice#84]
   +- Join Inner, ((l_quantity#83 < avg_quantity#430) AND (key#436L = p_partkey#264L))
      :- Filter isnotnull(avg_quantity#430)
      :  +- Aggregate [p_partkey#264L], [p_partkey#264L AS key#436L, if (isnull(avg(l_quantity#83))) null else UDF(knownnotnull(avg(l_quantity#83))) AS avg_quantity#430]
      :     +- Project [p_partkey#264L, l_quantity#83]
      :        +- Join LeftOuter, (p_partkey#264L = l_partkey#80L)
      :           :- Project [p_partkey#264L]
      :           :  +- Filter ((isnotnull(p_brand#267) AND isnotnull(p_container#270)) AND ((p_brand#267 = Brand#23) AND (p_container#270 = MED BOX)))
      :           :     +- SerializeFromObject [knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_partkey AS p_partkey#264L, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_name, true, false, true) AS p_name#265, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_mfgr, true, false, true) AS p_mfgr#266, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_brand, true, false, true) AS p_brand#267, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_type, true, false, true) AS p_type#268, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_size AS p_size#269L, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_container, true, false, true) AS p_container#270, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_retailprice AS p_retailprice#271, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_comment, true, false, true) AS p_comment#272]
      :           :        +- MapElements main.scala.TpchSchemaProvider$$Lambda$1808/0x0000000840dba840@45a40353, class [Ljava.lang.String;, [StructField(value,ArrayType(StringType,true),true)], obj#263: main.scala.Part
      :           :           +- MapElements main.scala.TpchSchemaProvider$$Lambda$1807/0x0000000840db9840@41ae9f11, class java.lang.String, [StructField(value,StringType,true)], obj#249: [Ljava.lang.String;
      :           :              +- DeserializeToObject value#240.toString, obj#248: java.lang.String
      :           :                 +- Relation [value#240] text
      :           +- SerializeFromObject [knownnotnull(assertnotnull(input[0, main.scala.Lineitem, true])).l_partkey AS l_partkey#80L, knownnotnull(assertnotnull(input[0, main.scala.Lineitem, true])).l_quantity AS l_quantity#83]
      :              +- MapElements main.scala.TpchSchemaProvider$$Lambda$1800/0x0000000840daf840@3c130cb2, class [Ljava.lang.String;, [StructField(value,ArrayType(StringType,true),true)], obj#78: main.scala.Lineitem
      :                 +- MapElements main.scala.TpchSchemaProvider$$Lambda$1799/0x0000000840dab840@1f5a1ad4, class java.lang.String, [StructField(value,StringType,true)], obj#57: [Ljava.lang.String;
      :                    +- DeserializeToObject value#48.toString, obj#56: java.lang.String
      :                       +- Relation [value#48] text
      +- Project [p_partkey#264L, l_quantity#83, l_extendedprice#84]
         +- Join Inner, (p_partkey#264L = l_partkey#80L)
            :- Project [p_partkey#264L]
            :  +- Filter ((isnotnull(p_brand#267) AND isnotnull(p_container#270)) AND ((p_brand#267 = Brand#23) AND (p_container#270 = MED BOX)))
            :     +- SerializeFromObject [knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_partkey AS p_partkey#264L, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_name, true, false, true) AS p_name#265, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_mfgr, true, false, true) AS p_mfgr#266, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_brand, true, false, true) AS p_brand#267, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_type, true, false, true) AS p_type#268, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_size AS p_size#269L, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_container, true, false, true) AS p_container#270, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_retailprice AS p_retailprice#271, staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, knownnotnull(assertnotnull(input[0, main.scala.Part, true])).p_comment, true, false, true) AS p_comment#272]
            :        +- MapElements main.scala.TpchSchemaProvider$$Lambda$1808/0x0000000840dba840@45a40353, class [Ljava.lang.String;, [StructField(value,ArrayType(StringType,true),true)], obj#263: main.scala.Part
            :           +- MapElements main.scala.TpchSchemaProvider$$Lambda$1807/0x0000000840db9840@41ae9f11, class java.lang.String, [StructField(value,StringType,true)], obj#249: [Ljava.lang.String;
            :              +- DeserializeToObject value#439.toString, obj#248: java.lang.String
            :                 +- Relation [value#439] text
            +- SerializeFromObject [knownnotnull(assertnotnull(input[0, main.scala.Lineitem, true])).l_partkey AS l_partkey#80L, knownnotnull(assertnotnull(input[0, main.scala.Lineitem, true])).l_quantity AS l_quantity#83, knownnotnull(assertnotnull(input[0, main.scala.Lineitem, true])).l_extendedprice AS l_extendedprice#84]
               +- MapElements main.scala.TpchSchemaProvider$$Lambda$1800/0x0000000840daf840@3c130cb2, class [Ljava.lang.String;, [StructField(value,ArrayType(StringType,true),true)], obj#78: main.scala.Lineitem
                  +- MapElements main.scala.TpchSchemaProvider$$Lambda$1799/0x0000000840dab840@1f5a1ad4, class java.lang.String, [StructField(value,StringType,true)], obj#57: [Ljava.lang.String;
                     +- DeserializeToObject value#440.toString, obj#56: java.lang.String
                        +- Relation [value#440] text
